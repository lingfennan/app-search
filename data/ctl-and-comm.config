name: "control and communication channels"
config_filename: "/Users/ruian/Desktop/Android/app-search/data/ctl-and-comm.config"
rules {
  name: "socket communication"
  disjunct_rules {
    id: "tcp inet address"
    conjunct_rules {
      id: "tcp inet address"
      simple_rules {
        id: "inet"
        class_name {
	      content: "java.net.InetSocketAddress"
        }
        method_name_or_sub_signature {
          content: "<init>"
        }
      }
      simple_rules {
        id: "no bind"
        negate: true
        class_name {
          content: "java.net.ServerSocket"
        }
        method_name_or_sub_signature {
          content: "bind"
        }
      }
      simple_rules {
        id: "accept"
        class_name {
          content: "java.net.ServerSocket"
        }
        method_name_or_sub_signature {
          content: "accept"
        }
      }
    }
  }
  disjunct_rules {
  	id: "tcp port serversocket"
  	conjunct_rules {
  	  id: "tcp port serversocket"
  	  simple_rules {
  	    id: "socket init"
  	    class_name {
  	      content: "java.net.ServerSocket"
  	    }
  	    method_name_or_sub_signature {
  	      content: "<init>"
  	    }
  	  }
      simple_rules {
        id: "accept"
        class_name {
          content: "java.net.ServerSocket"
        }
        method_name_or_sub_signature {
          content: "accept"
        }
      }
    }
  }
  disjunct_rules {
    id: "ssl port serversocket"
    conjunct_rules {
      id: "ssl port serversocket"
      simple_rules {
        id: "create socket"
        class_name {
          content: "javax.net.ssl.SSLServerSocketFactory"
        }
        method_name_or_sub_signature {
          content: "createServerSocket"
        }
      }
      simple_rules {
        id: "accept"
        class_name {
          content: "javax.net.ssl.SSLServerSocket"
        }
        method_name_or_sub_signature {
          content: "accept"
        }
      }
    }
  }
  disjunct_rules {
    id: "udp port socket"
    conjunct_rules {
      id: "udp port socket"
      simple_rules {
        id: "socket init"
        class_name {
          content: "java.net.DatagramPacket"
        }
        method_name_or_sub_signature {
          content: "<init>"
        }
      }
      simple_rules {
        id: "no send"
        negate: true
        class_name {
          content: "java.net.DatagramSocket"
        }
        method_name_or_sub_signature {
          content: "send"
        }
      }
      simple_rules {
        id: "receive"
        class_name {
          content: "java.net.DatagramSocket"
        }
        method_name_or_sub_signature {
          content: "receive"
        }
      }
    }
  }
  disjunct_rules {
    id: "udp inet socket"
    conjunct_rules {
      id: "udp inet socket"
      simple_rules {
        id: "inet"
        class_name {
	      content: "java.net.InetSocketAddress"
        }
        method_name_or_sub_signature {
          content: "<init>"
        }
      }
      simple_rules {
        id: "receive"
        class_name {
          content: "java.net.DatagramSocket"
        }
        method_name_or_sub_signature {
          content: "receive"
        }
      }
    }
  }
}
rules {
  name: "bluetooth"
  disjunct_rules {
    id: "used bluetooth"
    conjunct_rules {
      id: "used bluetooth"
      simple_rules {
        id: "bluetooth permissions"
        permissions: {
          content: "android.permission.BLUETOOTH"
        }
        permissions: {
          content: "android.permission.BLUETOOTH_ADMIN"
        }
      }
    }
  }
  disjunct_rules {
    id: "connect to paired devices"
    conjunct_rules {
      id: "connect to paired devices"
      simple_rules {
        id: "get devices"
        class_name {
          content: "android.bluetooth.BluetoothAdapter"
        }
        method_name_or_sub_signature {
          content: "getBondedDevices"
        }
      }
      simple_rules {
        id: "create socket"
        class_name {
          content: "android.bluetooth.BluetoothDevice"
        }
        method_name_or_sub_signature {
          content: "createRfcommSocketToServiceRecord"
        }
      }
      simple_rules {
        id: "connect"
        class_name {
          content: "android.bluetooth.BluetoothSocket"
        }
        method_name_or_sub_signature {
          content: "connect"
        }
      }
    }
  }
  disjunct_rules {
    id: "discover other devices"
    conjunct_rules {
      id: "discover other devices and connect to them"
      simple_rules {
        id: "discover"
        class_name {
          content: "android.bluetooth.BluetoothAdapter"
        }
        method_name_or_sub_signature {
          content: "startDiscovery"
        }
      }
      simple_rules {
        id: "create socket"
        class_name {
          content: "android.bluetooth.BluetoothDevice"
        }
      }
      simple_rules {
        id: "connect"
        class_name {
          content: "android.bluetooth.BluetoothSocket"
        }
        method_name_or_sub_signature {
          content: "connect"
        }
      }
    }
  }
  disjunct_rules {
    id: "discover other devices using LeScan"
    conjunct_rules {
      id: "discover using startLeScan"
      simple_rules {
        id: "discover"
        class_name {
          content: "android.bluetooth.BluetoothAdapter"
        }
        method_name_or_sub_signature {
          content: "startLeScan"
        }
      }
      simple_rules {
        id: "create socket"
        class_name {
          content: "android.bluetooth.BluetoothDevice"
        }
        method_name_or_sub_signature {
          content: "createRfcommSocketToServiceRecord"
        }
      }
      simple_rules {
        id: "connect"
        class_name {
          content: "android.bluetooth.BluetoothSocket"
        }
        method_name_or_sub_signature {
          content: "connect"
        }
      }
    }
  }
  disjunct_rules {
    id: "wait for other devices to connect"
    conjunct_rules {
      id: "wait for other devices to connect"
      simple_rules {
        id: "wait"
        class_name {
      	  content: "android.bluetooth.BluetoothAdapter"
      	}
      	method_name_or_sub_signature {
      	  content: "listenUsingRfcommWithServiceRecord"
      	}
      }
      simple_rules {
        id: "accept"
        class_name {
          content: "android.bluetooth.BluetoothServerSocket"
        }
        method_name_or_sub_signature {
          content: "accept"
        }
      }
    }
  }
}
rules {
  name: "wifi p2p"
  disjunct_rules {
    id: "uses wifi p2p"
    conjunct_rules {
      id: "permission wifi"
      simple_rules {
        id: "permission wifi"
        permissions {
          content: "android.permission.ACCESS_WIFI_STATE"
        }
        permissions {
          content: "android.permission.CHANGE_WIFI_STATE"
        }
        permissions {
          content: "android.permission.INTERNET"
        }
        class_name {
          content: "android.net.wifi.p2p.WifiP2pManager"
        }
      }
    }
  }
  disjunct_rules {
    id: "find peers"
    conjunct_rules {
      id: "find and connect to peers"
      simple_rules {
        id: "initialize"
        class_name {
          content: "android.net.wifi.p2p.WifiP2pManager"
        }
        method_name_or_sub_signature {
          content: "initialize"
        }
      }
      simple_rules {
        id: "discover"
        class_name {
          content: "android.net.wifi.p2p.WifiP2pManager"
        }
        method_name_or_sub_signature {
          content: "discoverPeers"
        }
      }
    }
    conjunct_rules {
      id: "normal server socket"
      simple_rules {
        id: "connect"
        class_name {
          content: "java.net.ServerSocket"
        }
        method_name_or_sub_signature {
          content: "connect"
        }
      }
    }
  }
  disjunct_rules {
    id: "find services"
    conjunct_rules {
      id: "find and connect to peers"
      simple_rules {
        id: "initialize"
        class_name {
          content: "android.net.wifi.p2p.WifiP2pManager"
        }
        method_name_or_sub_signature {
          content: "initialize"
        }
      }
      simple_rules {
        id: "discover"
        class_name {
          content: "android.net.wifi.p2p.WifiP2pManager"
        }
        method_name_or_sub_signature {
          content: "discoverServices"
        }
      }
    }
    conjunct_rules {
      id: "normal server socket"
      simple_rules {
        id: "connect"
        class_name {
          content: "java.net.ServerSocket"
        }
        method_name_or_sub_signature {
          content: "connect"
        }
      }
    }
  }
}
rules {
  name: "android nfc"
  disjunct_rules {
    id: "uses android nfc"
    conjunct_rules {
      id: "android nfc"
      simple_rules {
        id: "permission nfc"
        permissions {
          content: "android.permission.NFC"
        }
      }
    }
  }
  disjunct_rules {
    id: "reader/writer mode"
    conjunct_rules {
      id: "reader writer"
      simple_rules {
        id: "enable reader mode"
        class_name {
          content: "android.nfc.NfcAdapter"
        }
        method_name_or_sub_signature {
          content: "enableReaderMode"
        }
      }
      simple_rules {
        id: "nfc message"
        class_name {
          content: "android.nfc.NdefMessage"
        }
      }
      simple_rules {
        id: "nfc record"
        class_name {
          content: "android.nfc.NdefRecord"
        }
      }
    }
  }
  disjunct_rules {
    id: "p2p mode"
    conjunct_rules {
      id: "communicate"
      simple_rules {
        id: "msg init"
        class_name {
          content: "android.nfc.NdefMessage"
        }
        method_name_or_sub_signature {
          content: "<init>"
        }
      }
      simple_rules {
        id: "msg push"
        class_name {
          content: "android.nfc.NfcAdapter"
        }
        method_name_or_sub_signature {
          content: "setNdefPushMessage"
        }
      }
    }
  }
  disjunct_rules {
    id: "p2p mode with callback"
    conjunct_rules {
      id: "communicate with callback"
      simple_rules {
        id: "msg init"
        class_name {
          content: "android.nfc.NdefMessage"
        }
        method_name_or_sub_signature {
          content: "<init>"
        }
      }
      simple_rules {
        id: "msg push with callback"
        class_name {
          content: "android.nfc.NfcAdapter"
        }
        method_name_or_sub_signature {
          content: "setNdefPushMessageCallback"
        }
      }
    }
  }
  disjunct_rules {
    id: "card emulation host-based"
    conjunct_rules {
      id: "host based"
      simple_rules {
        id: "process apdu"
        method_name_or_sub_signature {
          content: "processCommandApdu"
        }
      }
    }
  }
  disjunct_rules {
    id: "card emulation off-host"
    conjunct_rules {
      id: "off-host"
      simple_rules {
        id: "off host class"
        class_name {
          content: "OffHostApduService"
        }
      }
    }
  } 
}
